<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Customer Weekly Minutes Tracker — Updated</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Manifest for PWA install -->
<link rel="manifest" href="manifest.json">

<!-- Tree favicon -->
<link rel="icon" type="image/png" href="icons/icon-192.png">

<style>
    html { min-height: 100%; }
    body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #f4f4f9; padding: 20px; margin: 0; min-height: 100vh; }
    .container { max-width: 1000px; margin: auto; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    h2 { color: #333; }

    .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; background: #fafafa; padding: 15px; border-radius: 8px; border: 1px solid #eee; }
    .control-group { display: flex; flex-direction: column; gap: 10px; }
    .controls label { font-weight: 600; color: #555; font-size: 0.9em; }
    input[type="text"], input[type="date"], input[type="time"], select { padding: 8px; font-size: 16px; border: 1px solid #ccc; border-radius: 4px; width: 100%; box-sizing: border-box; }
    button.add-btn { padding: 12px; border: none; background: #4CAF50; color: white; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: auto; }
    button.add-btn:hover { background: #45a049; }

    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
    th { background: #4CAF50; color: white; }

    .customer-link { color: #2196F3; font-weight: bold; text-decoration: underline; cursor: pointer; }
    .customer-link:hover { color: #0b7dda; }

    .view-section { display: none; }
    .active-view { display: block; }

    .back-btn { background: #666; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; margin-bottom: 15px; }
    .back-btn:hover { background: #555; }

    .delete-btn { background: #ff4444; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; }
    .delete-btn:hover { background: #cc0000; }

    .small { font-size: 0.85em; color: #666; }

    @media (max-width: 800px) { .controls { grid-template-columns: 1fr; } }
</style>
</head>

<body>

<div class="container">

    <!-- DASHBOARD -->
    <div id="dashboardView" class="view-section active-view">
        <h2>Weekly Customer Minutes Tracker</h2>

        <div class="controls">
            <div class="control-group">
                <label>Customer Name: <input type="text" id="customer" placeholder="e.g. Greenlands"></label>
                <label>Start Time: <input type="time" id="startTime"></label>
                <label>Finish Time: <input type="time" id="finishTime"></label>
            </div>

            <div class="control-group">
                <label>Worker Names (comma separated): <input type="text" id="workerNames" placeholder="John, Alex, Sarah"></label>
                <label>Date: <input type="date" id="workDate"></label>
                <div style="display:flex;gap:10px;">
                    <button class="add-btn" onclick="addRecord()">Add Entry</button>
                    <button class="add-btn" style="background:#1976d2" onclick="openWorkerTotals()">Worker Totals</button>
                </div>
            </div>
        </div>

        <h3>All Entries</h3>
        <table id="minutesTable">
            <thead>
            <tr>
                <th>Customer</th>
                <th>Total Minutes</th>
                <th>Hours</th>
                <th>Breakdown</th>
                <th>Workers</th>
                <th>Time & Date</th>
                <th>Action</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <!-- CUSTOMER VIEW -->
    <div id="customerView" class="view-section">
        <button class="back-btn" onclick="showDashboard()">← Back to Dashboard</button>
        <h2 id="customerTitle">Customer Details</h2>
        <div id="customerTotals" class="small" style="margin-bottom:10px;"></div>
        <table id="customerTable">
            <thead>
            <tr>
                <th>Total Minutes</th>
                <th>Hours</th>
                <th>Breakdown</th>
                <th>Workers</th>
                <th>Time & Date</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <!-- WORKER TOTALS VIEW -->
    <div id="workerView" class="view-section">
        <button class="back-btn" onclick="showDashboard()">← Back to Dashboard</button>
        <h2>Worker Totals</h2>
        <div class="controls" style="grid-template-columns: 1fr 1fr 1fr;">
            <div class="control-group">
                <label>Period:
                    <select id="periodSelect">
                        <option value="day">Day</option>
                        <option value="week">Week</option>
                        <option value="month">Month</option>
                        <option value="year">Year</option>
                    </select>
                </label>
            </div>
            <div class="control-group">
                <label>Reference Date: <input type="date" id="periodDate"></label>
            </div>
            <div class="control-group" style="align-items:flex-end;">
                <button class="add-btn" onclick="showWorkerTotals()">Show Totals</button>
            </div>
        </div>

        <h3>Totals for Selected Period</h3>
        <div id="workerPeriodSummary" class="small" style="margin-bottom:8px;"></div>
        <table id="workerTable">
            <thead>
            <tr>
                <th>Worker</th>
                <th>Total Minutes</th>
                <th>Hours</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

</div>

<script>
    /* JS unchanged — omitted here for space, but include your full script */
</script>

<!-- Service worker registration -->
<script>
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
